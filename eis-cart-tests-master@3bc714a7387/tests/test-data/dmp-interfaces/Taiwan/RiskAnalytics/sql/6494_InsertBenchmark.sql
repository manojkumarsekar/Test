Insert into FT_T_BNCH (BNCH_OID, ORG_ID, SUBD_ORG_ID,SUBDIV_ID,BNCHMRK_TYP_OID,START_TMS,END_TMS,REF_BNCH_OID,MKT_OID,INST_MNEM,FINSRL_TYP,BNCHMRK_PROV_ID,PREF_BNCHMRK_ID_CTXT_TYP,PREF_BNCHMRK_ID,BNCHMRK_LEVEL_TYP,BASE_CURR_CDE,LOCAL_CURR_CDE,MAINT_ENABLED_IND,HEDGED_IND,BNCHMRK_PUBLISH_TYP,REBAL_FQ_DY_TYP,REBAL_FQ_SP_TYP,WEIGHT_METH_TYP,LAST_CHG_TMS,LAST_CHG_USR_ID,BNCHMRK_NME,BNCHMRK_DESC,DATA_STAT_TYP,DATA_SRC_ID,BNCHMRK_CALC_STAT_TYP,BNCHMRK_CALC_IND,SERIES_TYP,MARKIT_VER_NUM,PAY_FQ_SP_TYP,PAY_FQ_QTY,PAY_FQ_DY_TYP,DUR_PERIOD_TYP,CNTRCT_FIXED_CRTE,INDX_MLTPLR_CRTE,DEC_PREC_NUM,REBAL_FQ_QTY,BNCHMRK_SEC_TYP,BNCHMRK_TENOR_TYP,METH_ID,FILTER_NME,FILTER_VAL_TXT,DAYS_YR_BAS_TYP,BNCHMRK_PROV_NME,BNCHMRK_PROV_SUB_NME,BNCHMRK_EFF_DTE,BNCHMRK_ANNEX_DTE,ACTIVE_VER_IND,FIRST_PY_DTE,RECOVERY_CRTE,MATURITY_DTE,FWD_IND)
SELECT new_oid,null,null,null,'BMTYPE0001',sysdate,null,null,null,null,null,null,null,null,'TOTAL','USD',null,null,'N',null,null,'NA',null,SYSDATE,'EIS:CSTM','GAA_ALGENS','GAA_ALGENS','ACTIVE',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNCH WHERE BNCHMRK_NME='GAA_ALGENS' AND BNCHMRK_DESC='GAA_ALGENS');

Insert into FT_T_BNID (BNID_OID,BNCH_OID,ORG_ID,SUBD_ORG_ID,SUBDIV_ID,BNCHMRK_ID_CTXT_TYP,BNCHMRK_ID,START_TMS,END_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,DATA_SRC_ID,BNCHMRK_TENOR_TYP)
SELECT new_oid,(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,null,null,'BRSBNCHID','GAA_ALGENS',SYSDATE,null,SYSDATE,'EIS:CSTM','ACTIVE',null,null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNID WHERE BNCHMRK_ID='GAA_ALGENS' AND BNCHMRK_ID_CTXT_TYP = 'BRSBNCHID');

Insert into FT_T_BNID (BNID_OID,BNCH_OID,ORG_ID,SUBD_ORG_ID,SUBDIV_ID,BNCHMRK_ID_CTXT_TYP,BNCHMRK_ID,START_TMS,END_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,DATA_SRC_ID,BNCHMRK_TENOR_TYP)
SELECT new_oid,(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,null,null,'RDMCODE','GAA_ALGENS',SYSDATE,null,SYSDATE,'EIS:CSTM','ACTIVE',null,null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNID WHERE BNCHMRK_ID='GAA_ALGENS' AND BNCHMRK_ID_CTXT_TYP = 'RDMCODE');

Insert into FT_T_BNCL (BNCL_OID,BNCH_OID,INDUS_CL_SET_ID,CLSF_OID,CL_VALUE,CLSF_PURP_TYP,START_TMS,END_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,DATA_SRC_ID,EINC_OID)
SELECT new_oid,(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),'EISBNCHCAT','EIS0000009','Drifted',null,sysdate,null,sysdate,'EIS:CSTM','ACTIVE',null,null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNCL WHERE CL_VALUE='Drifted' AND INDUS_CL_SET_ID ='EISBNCHCAT' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'ALLDNSUP',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'No','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='ALLDNSUP' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'BACTVFLG',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'Y','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='BACTVFLG' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'BNENID',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'GAA_ALGENS','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='BNENID' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'BNENTYP',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'RDMCODE','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='BNENTYP' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'BNPPERF',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'N','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='BNPPERF' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'BNPSUP',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'No','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='BNPSUP' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_BNST (BNST_OID,STAT_DEF_ID,BNCH_OID,STATS_CURR_CDE,STATS_EFF_TMS,STATS_COR_TMS,LAST_CHG_TMS,LAST_CHG_USR_ID,STAT_VAL_DTE,STAT_VAL_TMS,STAT_VAL_CAMT,STAT_INT_VAL_NUM,STAT_CHAR_VAL_TXT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'FWRDFLAG',(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),null,sysdate,null,sysdate,'EIS:CSTM',null,null,null,null,'No','ACTIVE',null
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_BNST WHERE STAT_DEF_ID='FWRDFLAG' AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

Insert into FT_T_ABMR (ABMR_OID,ORG_ID,BK_ID,ACCT_ID,BNCH_OID,RL_TYP,START_TMS,END_TMS,LAST_CHG_USR_ID,LAST_CHG_TMS,RL_DESC,PART_CAMT,PART_CURR_CDE,PART_CPCT,DATA_STAT_TYP,DATA_SRC_ID)
SELECT new_oid,'EIS ','EIS ',(SELECT ACCT_ID FROM FT_T_ACID WHERE ACCT_ALT_ID = 'ALGENS' AND ACCT_ID_CTXT_TYP ='CRTSID' AND END_TMS IS NULL),(SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL),'PRIMARY ',sysdate,null,'EIS:CSTM',sysdate,null,null,null,null,'ACTIVE','EIS'
FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM FT_T_ABMR WHERE ACCT_ID=(SELECT ACCT_ID FROM FT_T_ACID WHERE ACCT_ALT_ID = 'ALGENS' AND ACCT_ID_CTXT_TYP ='CRTSID'  AND END_TMS IS NULL) AND BNCH_OID = (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME ='GAA_ALGENS' AND END_TMS IS NULL));

UPDATE FT_T_BNST SET  STATS_EFF_TMS = to_date('01-JAN-1900', 'dd-MON-yyyy') where BNCH_OID in (SELECT BNCH_OID FROM FT_T_BNCH WHERE BNCHMRK_NME in ('GAA_ALGENS') AND END_TMS IS NULL);