    SELECT TO_CHAR(TRUNC(ADD_MONTHS(LAST_DAY(SYSDATE), 1),'MON'),'YYYY-MON-DD') AS MS_DATE,
           TO_CHAR(ADD_MONTHS(LAST_DAY(SYSDATE), 1),'YYYY-MON-DD') AS ME_DATE,
           TO_CHAR(LEAST(ADD_MONTHS(LAST_DAY(SYSDATE), 1), NEXT_DAY(ADD_MONTHS(LAST_DAY(SYSDATE), 1), 'Monday') - 3),'YYYY-MON-DD') AS ME_LAST_BD,
           TO_CHAR(LEAST(ADD_MONTHS(LAST_DAY(SYSDATE), 1), NEXT_DAY(ADD_MONTHS(LAST_DAY(SYSDATE), 1), 'Monday') - 3),'dd-Mon-yyyy') AS ME_LAST_BD_OUTPUT,
           TO_CHAR(LEAST(LAST_DAY(SYSDATE), NEXT_DAY(LAST_DAY(SYSDATE), 'Monday') - 3),'YYYY-MON-DD') AS PREV_ME_LAST_BD,
           TO_CHAR(LEAST(LAST_DAY(SYSDATE), NEXT_DAY(LAST_DAY(SYSDATE), 'Monday') - 3),'dd-Mon-yyyy') AS PREV_ME_LAST_BD_OUTPUT,
           MAX(usr_int_val_num_1) + 1 BATCH_NUMBER
    FROM   ft_t_wtrd
    WHERE  version_end_tmsmp > ADD_MONTHS(SYSDATE, -3)