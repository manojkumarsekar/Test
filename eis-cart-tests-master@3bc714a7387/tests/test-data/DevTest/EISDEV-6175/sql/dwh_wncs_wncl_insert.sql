-- WNCS insert
Insert into fT_T_wncs (INCS_SOK,INDUS_CL_SET_ID,CLSF_SET_MNEM,CLSF_SET_CURR_CDE,CL_SET_NME,CL_SET_PURP_TYP,GU_ID,GU_TYP,GU_NME,START_TMS,END_TMS,VERSION_START_TMSMP,DW_STATUS_NUM,VERSION_END_TMSMP,CLSF_AGENCY_NME,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,CLSF_TENOR_MNEM)
select NEW_OID,'E3CREDTAG','E3CREDTAG',null,'E3 CREDIT TAG Custom Classification',null,null,null,null,sysdate,to_date('31/12/99','DD/MM/RR'),to_timestamp(sysdate,'DD/MM/RR HH12:MI:SSXFF AM'),1,to_timestamp('31/12/99 12:00:00.000000000 AM','DD/MM/RR HH12:MI:SSXFF AM'),null,sysdate,'autotest',null,null from dual
where not exists (select 1 from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num =1);

Insert into fT_T_wncs (INCS_SOK,INDUS_CL_SET_ID,CLSF_SET_MNEM,CLSF_SET_CURR_CDE,CL_SET_NME,CL_SET_PURP_TYP,GU_ID,GU_TYP,GU_NME,START_TMS,END_TMS,VERSION_START_TMSMP,DW_STATUS_NUM,VERSION_END_TMSMP,CLSF_AGENCY_NME,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,CLSF_TENOR_MNEM)
select NEW_OID,'ESICRESCT','ESICRESCT',null,'ESI_CORE_SECT_PATH',null,null,null,null,sysdate,to_date('31/12/99','DD/MM/RR'),to_timestamp(sysdate,'DD/MM/RR HH12:MI:SSXFF AM'),1,to_timestamp('31/12/99 12:00:00.000000000 AM','DD/MM/RR HH12:MI:SSXFF AM'),null,to_date('04/12/19','DD/MM/RR'),'autotest','ACTIVE',null from dual
where not exists (select 1 from ft_t_wncs where INDUS_CL_SET_ID = 'ESICRESCT' and dw_status_num =1);

-- WNCL insert
Insert into FT_T_WNCL (INDUS_CLSF_SOK,INCS_SOK,CL_VALUE,LEVEL_NUM,CLSF_OID,PRNT_INDUS_CLSF_SOK,START_TMS,END_TMS,CL_NME,CL_DESC,DATA_SRC_ID,VERSION_START_TMSMP,DW_STATUS_NUM,CLASS_LVL0,CLASS_LVL1,CLASS_LVL2,CLASS_LVL3,CLASS_LVL4,CLASS_LVL5,CLASS_LVL6,CLASS_LVL7,CLASS_LVL0_VALUE,CLASS_LVL1_VALUE,CLASS_LVL2_VALUE,CLASS_LVL3_VALUE,CLASS_LVL4_VALUE,CLASS_LVL5_VALUE,CLASS_LVL6_VALUE,CLASS_LVL7_VALUE,VERSION_END_TMSMP,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,CLASS_LVL8,CLASS_LVL9,CLASS_LVL10,CLASS_LVL8_VALUE,CLASS_LVL9_VALUE,CLASS_LVL10_VALUE)
select new_oid,(select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1),'Credit',1,null,null,sysdate,to_date('31/12/99','DD/MM/RR'),'Credit','Credit',null,to_timestamp(sysdate,'DD/MM/RR HH12:MI:SSXFF AM'),1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,to_timestamp('31/12/99 12:00:00.000000000 AM','DD/MM/RR HH12:MI:SSXFF AM'),sysdate,'autotest',null,null,null,null,null,null,null from dual
where not exists (select 1 from fT_T_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Credit');

Insert into FT_T_WNCL (INDUS_CLSF_SOK,INCS_SOK,CL_VALUE,LEVEL_NUM,CLSF_OID,PRNT_INDUS_CLSF_SOK,START_TMS,END_TMS,CL_NME,CL_DESC,DATA_SRC_ID,VERSION_START_TMSMP,DW_STATUS_NUM,CLASS_LVL0,CLASS_LVL1,CLASS_LVL2,CLASS_LVL3,CLASS_LVL4,CLASS_LVL5,CLASS_LVL6,CLASS_LVL7,CLASS_LVL0_VALUE,CLASS_LVL1_VALUE,CLASS_LVL2_VALUE,CLASS_LVL3_VALUE,CLASS_LVL4_VALUE,CLASS_LVL5_VALUE,CLASS_LVL6_VALUE,CLASS_LVL7_VALUE,VERSION_END_TMSMP,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,CLASS_LVL8,CLASS_LVL9,CLASS_LVL10,CLASS_LVL8_VALUE,CLASS_LVL9_VALUE,CLASS_LVL10_VALUE)
select new_oid,(select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1),'Non Credit',1,null,null,sysdate,to_date('31/12/99','DD/MM/RR'),'Non Credit','Non Credit',null,to_timestamp(sysdate,'DD/MM/RR HH12:MI:SSXFF AM'),1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,to_timestamp('31/12/99 12:00:00.000000000 AM','DD/MM/RR HH12:MI:SSXFF AM'),sysdate,'autotest',null,null,null,null,null,null,null from dual
where not exists (select 1 from fT_T_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Non Credit');

Insert into FT_T_WNCL (INDUS_CLSF_SOK,INCS_SOK,CL_VALUE,LEVEL_NUM,CLSF_OID,PRNT_INDUS_CLSF_SOK,START_TMS,END_TMS,CL_NME,CL_DESC,DATA_SRC_ID,VERSION_START_TMSMP,DW_STATUS_NUM,CLASS_LVL0,CLASS_LVL1,CLASS_LVL2,CLASS_LVL3,CLASS_LVL4,CLASS_LVL5,CLASS_LVL6,CLASS_LVL7,CLASS_LVL0_VALUE,CLASS_LVL1_VALUE,CLASS_LVL2_VALUE,CLASS_LVL3_VALUE,CLASS_LVL4_VALUE,CLASS_LVL5_VALUE,CLASS_LVL6_VALUE,CLASS_LVL7_VALUE,VERSION_END_TMSMP,LAST_CHG_TMS,LAST_CHG_USR_ID,DATA_STAT_TYP,CLASS_LVL8,CLASS_LVL9,CLASS_LVL10,CLASS_LVL8_VALUE,CLASS_LVL9_VALUE,CLASS_LVL10_VALUE)
select new_oid,(select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'ESICRESCT' and dw_status_num=1),'Fixed Income',2,null,null,sysdate,to_date('31/12/99','DD/MM/RR'),'Fixed Income',null,'BRS',to_timestamp(sysdate,'DD/MM/RR HH12:MI:SSXFF AM'),1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,to_timestamp('31/12/99 12:00:00.000000000 AM','DD/MM/RR HH12:MI:SSXFF AM'),sysdate,'autotest','ACTIVE',null,null,null,null,null,null from dual
where not exists (select 1 from fT_T_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'ESICRESCT' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Fixed Income');

-- WISL insert

delete from ft_t_wisl where iss_sok in (select iss_sok from fT_t_wisu where isin_id = 'US4642868719' and dw_status_num = 1) and CLSF_SET_MNEM in ('ESICRESCT','E3CREDTAG');

delete from ft_t_wisl where iss_sok in (select iss_sok from fT_t_wisu where pref_iss_desc like 'EASTSPRING INV HONG KONG EQ D%' and dw_status_num = 1) and CLSF_SET_MNEM in ('ESICRESCT','E3CREDTAG');

Insert into FT_T_wisl (ISCL_SOK,ISS_SOK,INDUS_CLSF_SOK,CLSF_PURP_TYP,START_TMS,END_TMS,LAST_CHG_TMS,DW_STATUS_NUM,DW_ACTIVE_IND,VERSION_START_TMSMP,VERSION_END_TMSMP,LAST_CHG_USR_ID,CLSF_SET_MNEM,CL_SET_NME,CL_NME,CL_VALUE,ID_CTXT_TYP,ISS_ID,ISS_CLSF_OID,DATA_STAT_TYP,RPTG_PRD_START_DTE,RPTG_PRD_END_DTE,DATA_SRC_ID)
select new_oid,(select iss_sok from fT_t_wisu where isin_id = 'US4642868719' and pref_iss_nme='ISHARES MSCI HONG KONG ETF' and dw_status_num = 1),(select INDUS_CLSF_SOK from ft_t_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'ESICRESCT' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Fixed Income'),null,sysdate,sysdate,sysdate,1,null,sysdate,sysdate,'autotest','ESICRESCT','ESI_CORE_SECT_PATH','Fixed Income','Fixed Income',null,null,null,'ACTIVE',null,null,'BRS' from dual
where not exists (select 1 from ft_t_wisl where iss_sok = (select iss_sok from fT_t_wisu where isin_id = 'US4642868719' and pref_iss_nme='ISHARES MSCI HONG KONG ETF' and dw_status_num = 1) and CLSF_SET_MNEM = 'ESICRESCT');

Insert into FT_T_wisl (ISCL_SOK,ISS_SOK,INDUS_CLSF_SOK,CLSF_PURP_TYP,START_TMS,END_TMS,LAST_CHG_TMS,DW_STATUS_NUM,DW_ACTIVE_IND,VERSION_START_TMSMP,VERSION_END_TMSMP,LAST_CHG_USR_ID,CLSF_SET_MNEM,CL_SET_NME,CL_NME,CL_VALUE,ID_CTXT_TYP,ISS_ID,ISS_CLSF_OID,DATA_STAT_TYP,RPTG_PRD_START_DTE,RPTG_PRD_END_DTE,DATA_SRC_ID)
select new_oid,(select iss_sok from fT_t_wisu where isin_id = 'US4642868719' and pref_iss_nme='ISHARES MSCI HONG KONG ETF' and dw_status_num = 1),(select INDUS_CLSF_SOK from ft_t_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Non Credit'),null,sysdate,sysdate,sysdate,1,null,sysdate,sysdate,'autotest','E3CREDTAG','E3 CREDIT TAG Custom Classification','Non Credit','Non Credit',null,null,null,'ACTIVE',null,null,'BRS' from dual
where not exists (select 1 from ft_t_wisl where iss_sok = (select iss_sok from fT_t_wisu where isin_id = 'US4642868719' and pref_iss_nme='ISHARES MSCI HONG KONG ETF' and dw_status_num = 1) and CLSF_SET_MNEM = 'E3CREDTAG');

Insert into FT_T_wisl (ISCL_SOK,ISS_SOK,INDUS_CLSF_SOK,CLSF_PURP_TYP,START_TMS,END_TMS,LAST_CHG_TMS,DW_STATUS_NUM,DW_ACTIVE_IND,VERSION_START_TMSMP,VERSION_END_TMSMP,LAST_CHG_USR_ID,CLSF_SET_MNEM,CL_SET_NME,CL_NME,CL_VALUE,ID_CTXT_TYP,ISS_ID,ISS_CLSF_OID,DATA_STAT_TYP,RPTG_PRD_START_DTE,RPTG_PRD_END_DTE,DATA_SRC_ID)
select new_oid,(select iss_sok from fT_t_wisu where pref_iss_desc='EASTSPRING INV HONG KONG EQ D' and dw_status_num = 1),(select INDUS_CLSF_SOK from ft_t_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'ESICRESCT' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Fixed Income'),null,sysdate,sysdate,sysdate,1,null,sysdate,sysdate,'autotest','ESICRESCT','ESI_CORE_SECT_PATH','Fixed Income','Fixed Income',null,null,null,'ACTIVE',null,null,'BRS' from dual
where not exists (select 1 from ft_t_wisl where iss_sok = (select iss_sok from fT_t_wisu where pref_iss_desc='EASTSPRING INV HONG KONG EQ D' and dw_status_num = 1) and CLSF_SET_MNEM = 'ESICRESCT');

Insert into FT_T_wisl (ISCL_SOK,ISS_SOK,INDUS_CLSF_SOK,CLSF_PURP_TYP,START_TMS,END_TMS,LAST_CHG_TMS,DW_STATUS_NUM,DW_ACTIVE_IND,VERSION_START_TMSMP,VERSION_END_TMSMP,LAST_CHG_USR_ID,CLSF_SET_MNEM,CL_SET_NME,CL_NME,CL_VALUE,ID_CTXT_TYP,ISS_ID,ISS_CLSF_OID,DATA_STAT_TYP,RPTG_PRD_START_DTE,RPTG_PRD_END_DTE,DATA_SRC_ID)
select new_oid,(select iss_sok from fT_t_wisu where pref_iss_desc='EASTSPRING INV HONG KONG EQ D' and dw_status_num = 1),(select INDUS_CLSF_SOK from ft_t_wncl where incs_sok = (select incs_sok from ft_t_wncs where INDUS_CL_SET_ID = 'E3CREDTAG' and dw_status_num=1) and dw_status_num=1 and CL_VALUE = 'Non Credit'),null,sysdate,sysdate,sysdate,1,null,sysdate,sysdate,'autotest','E3CREDTAG','E3 CREDIT TAG Custom Classification','Non Credit','Non Credit',null,null,null,'ACTIVE',null,null,'BRS' from dual
where not exists (select 1 from ft_t_wisl where iss_sok = (select iss_sok from fT_t_wisu where pref_iss_desc='EASTSPRING INV HONG KONG EQ D' and dw_status_num = 1) and CLSF_SET_MNEM = 'E3CREDTAG');
commit
