#https://jira.pruconnect.net/browse/EISDEV-6848
#https://collaborate.pruconnect.net/display/EISPRM/Morningstar+Peer+ranking+reports
#https://collaborate.pruconnect.net/display/EISTOMR4/Peer+Ranking+Inbound+Logical+Mapping#businessRequirements

# ===================================================================================================================================================================================
# Date            JIRA        Comments
# ===================================================================================================================================================================================
# 02/09/2020      EISDEV-6848    Peer rank data- SG SICAV Morningstar report
# 23/02/2021      EISDEV-7414    DATA_SRC_ID change
# ===================================================================================================================================================================================


@dw_interface_peer_ranking @dmp_dw_regression
@eisdev_6848_XLSX @eisdev_6848 @peer_ranking_dwh @eisdev_7414
Feature: Load and Update SG SICAV Morningstar XLSX report and verify details

  This is to test if SG SICAV MorningStar Peer Ranking XLSX files are getting converted to CSV format and getting loaded in DWH
  And verify if various columns are populated as per expectation

  Background:

    Given I set the DMP workflow web service endpoint to named configuration "dwh.ws.WORKFLOW"
    And I set the database connection to configuration "dmp.db.DW"

  Scenario: Assign Variables

    Given  I assign "tests/test-data/dmp-interfaces/PeerRanking/EISDEV-6848" to variable "testdata.path"
    And I generate value with date format "YYYYMMdd-HHmmss" and assign to variable "VAR_SYSDATE"
    And I assign "Processed_SICAV_Mtking_Peer_Ranking_Load_ES_20200908_SICAV_M_PR_-_All_Funds1_ES_20200908.csv" to variable "OUTPUT_FILENAME_SGSICAV"
    And I assign "Processed_SICAV_Mtking_Peer_Ranking_Update_ES_20200908_SICAV_M_PR_-_All_Funds1_ES_20200908.csv" to variable "OUTPUT_FILENAME_UPDATE_MY_SGSICAV"
    And I assign "/dmp/in/" to variable "PEERRANK_DOWNLOAD_DIR"
    And I assign "/dmp/out/" to variable "PEERRANK_UPLOAD_DIR"

  Scenario: Remove files already present in directory

    Given I remove below files with pattern in the host "dmp.ssh.inbound" from folder "${PEERRANK_DOWNLOAD_DIR}" if exists:
      | *.xlsx |

    And I remove below files with pattern in the host "dmp.ssh.inbound" from folder "${PEERRANK_UPLOAD_DIR}" if exists:
      | *.csv |

  Scenario: Clear old test data and setup variables

    And I execute below query
    """
      UPDATE ft_t_wcri SET DW_STATUS_NUM=0,VERSION_END_TMSMP = TO_DATE('${VAR_SYSDATE}','YYYYMMDD-HH24MISS') WHERE DATA_SRC_ID = 'MSSGSICAV' AND DW_STATUS_NUM =1 and ACCT_SOK = (select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT');
      UPDATE fT_T_wagp SET DW_STATUS_NUM=0,VERSION_END_TMSMP = TO_DATE('${VAR_SYSDATE}','YYYYMMDD-HH24MISS') where DATA_SRC_ID = 'MSSGSICAV' AND ACCT_PRT_PURP_TYP='PRRNKPCT' and dw_Status_num =1 and prnt_wagr_sok in (select wagr_sok from ft_T_wagr where dw_Status_num =1 and ACCT_GRP_PURP_TYP='PRRNKGR' and ACCT_GRP_DESC ='EAA Fund Asia ex-Japan Equity');
      UPDATE fT_T_wagr SET DW_STATUS_NUM=0,VERSION_END_TMSMP = TO_DATE('${VAR_SYSDATE}','YYYYMMDD-HH24MISS') where DATA_SRC_ID = 'MSSGSICAV' AND dw_Status_num =1 and ACCT_GRP_PURP_TYP='PRRNKGR' and ACCT_GRP_DESC ='EAA Fund Asia ex-Japan Equity';
    """

  Scenario: Run Excel to CSV Peer Ranking workflow

    Given I copy files below from local folder "${testdata.path}/testdata" to the host "dmp.ssh.inbound" folder "${PEERRANK_DOWNLOAD_DIR}":
      | SICAV Mtking Peer Ranking Load (ES)_20200908.xlsx |

    And I assign "tests/test-data/intf-specs/gswf/template/EIS_PeerFundRanking_ExceltoCSV_DWH/request.xmlt" to variable "PROC_EXCEL"

    And I process the workflow template file "${PROC_EXCEL}" with below parameters and wait for the job to be completed
      | BEAN_SHELL_EXCEL_URI    | db://resource/EASTSPRING/script/EIS_Process_PeerRank_ExceltoCSV_XLSX.bshi |
      | MESSAGE_TYPE            | EIS_MT_MS_DWH_PEERRANKING_SG_SICAV                                        |
      | INPUT_DATA_DIR          | ${PEERRANK_DOWNLOAD_DIR}                                                  |
      | HEADERURI               | db://resource/propertyfiles/EISPeerRankingHeader.properties               |
      | FILEPATTERN             | *.xlsx                                                                    |
      | LOAD_FILE_PATTERNS      | Processed_*SICAV_Mtking_Peer_Ranking*.csv                                 |
      | PARALLELISM             | 1                                                                         |
      | OUTPUT_DATA_DIR         | ${PEERRANK_UPLOAD_DIR}                                                    |
      | PARAMETERSURI           | db://resource/propertyfiles                                               |
      | SUCCESS_ACTION          | LEAVE                                                                     |
      | LIST_SHEET_NAME         | SICAV M PR - All Funds1 (ES)                                              |
      | REPROCESSPROCESSEDFILES | true                                                                      |

    Then I expect below files to be present in the host "dmp.ssh.inbound" into folder "${PEERRANK_UPLOAD_DIR}" after processing:
      | ${OUTPUT_FILENAME_SGSICAV} |

    Then I extract new job id from jblg table into a variable "JOB_ID"

    And I expect value of column "JBLG_ROW_COUNT" in the below SQL query equals to "1":
    """
      SELECT COUNT(1) AS JBLG_ROW_COUNT FROM FT_T_JBLG WHERE JOB_ID = '${JOB_ID}' AND TASK_SUCCESS_CNT ='17'
    """

  Scenario: Perform checks in WAGR for checking load scenario

    Then I expect value of column "WAGR_COUNT" in the below SQL query equals to "1":
    """
      SELECT COUNT(*) AS WAGR_COUNT FROM FT_T_WAGR
      WHERE DATA_SRC_ID = 'MSSGSICAV' AND dw_Status_num =1 and ACCT_GRP_PURP_TYP='PRRNKGR' and ACCT_GRP_DESC ='EAA Fund Asia ex-Japan Equity'
    """

  Scenario: Perform checks in WAGP for checking load scenario

    Then I expect value of column "WAGP_COUNT" in the below SQL query equals to "1":
    """
      SELECT COUNT(*) AS WAGP_COUNT FROM FT_T_WAGP
      WHERE DATA_SRC_ID = 'MSSGSICAV' AND ACCT_PRT_PURP_TYP='PRRNKPCT' and dw_Status_num =1 and prnt_wagr_sok in (select wagr_sok from ft_T_wagr where dw_Status_num =1 and ACCT_GRP_PURP_TYP='PRRNKGR' and ACCT_GRP_DESC ='EAA Fund Asia ex-Japan Equity')
    """

  Scenario: Perform checks in WCRI for checking load scenario

    Then I expect value of column "WCRI_COUNT" in the below SQL query equals to "17":
    """
      SELECT COUNT(*) AS WCRI_COUNT FROM FT_T_WCRI
      WHERE DATA_SRC_ID = 'MSSGSICAV' AND DW_STATUS_NUM =1 and ACCT_SOK = (select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')
    """

  Scenario Outline: Verify the data uploaded all years except individual years in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                                   | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      | GroupInvestment                          | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                             | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-08-2020','DD-MM-YYYY')           |
      | ISIN                                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Month                   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RETURN_1M_CAMT='11.90033'                       |
      | PeerGroupRank1Month                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_1M_PGRP_RNK_NUM='1'                            |
      | PeerGroupQuartile1Month                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_1M_PGRP_QRTL_NUM='2'                       |
      | Noofinvestmentsrankedinpeergroup1Month   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_1M_PGRP_PART_NUM='3'        |

      | ReturnCumulative3Month                   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative3Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RETURN_3M_CAMT='-0.815822'                      |
      | PeerGroupRank3Month                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank3Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_3M_PGRP_RNK_NUM='4'                            |
      | PeerGroupQuartile3Month                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile3Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_3M_PGRP_QRTL_NUM='5'                       |
      | Noofinvestmentsrankedinpeergroup3Month   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup3Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_3M_PGRP_PART_NUM='6'        |

      | ReturnCumulative6Month                   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative6Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RETURN_6M_CAMT='-2.864989'                      |
      | PeerGroupRank6Month                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank6Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_6M_PGRP_RNK_NUM='7'                            |
      | PeerGroupQuartile6Month                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile6Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_6M_PGRP_QRTL_NUM='8'                       |
      | Noofinvestmentsrankedinpeergroup6Month   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup6Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RET_6M_PGRP_PART_NUM='9'        |

      | ReturnCumulativeYTDMonth                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulativeYTDMonth from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.YTD_RETURN_CAMT='-20.91465'                   |
      | PeerGroupRankYTDMonth                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRankYTDMonth from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.YTD_RET_PGRP_RNK_NUM='10'                        |
      | PeerGroupQuartileYTDMonth                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartileYTDMonth from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.YTD_RET_PGRP_QRTL_NUM='11'                   |
      | NoofinvestmentsrankedinpeergroupYTDMonth | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NoofinvestmentsrankedinpeergroupYTDMonth from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.YTD_RET_PGRP_PART_NUM='12'    |

      | ReturnCumulative1Yr                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='-4.898863'                    |
      | PeerGroupRank1Yr                         | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='13'                          |
      | PeerGroupQuartile1Yr                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='14'                     |
      | Noofinvestmentsrankedinpeergroup1Yr      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='15'      |

      | ReturnAnn3Yr                             | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnAnn3Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_3YR_RETURN_CAMT='-8.134976'                            |
      | PeerGroupRank3Yr                         | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank3Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_3Y_RET_PGRP_RNK_NUM='16'                           |
      | PeerGroupQuartile3Yr                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile3Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_3Y_RET_PGRP_QRTL_NUM='17'                      |
      | Noofinvestmentsrankedinpeergroup3Yr      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup3Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_3Y_RET_PGRP_PART_NUM='18'       |

      | ReturnAnn5Yr                             | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnAnn5Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_5YR_RETURN_CAMT='-0.278484'                            |
      | PeerGroupRank5Yr                         | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank5Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_5Y_RET_PGRP_RNK_NUM='19'                           |
      | PeerGroupQuartile5Yr                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile5Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_5Y_RET_PGRP_QRTL_NUM='20'                      |
      | Noofinvestmentsrankedinpeergroup5Yr      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup5Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_5Y_RET_PGRP_PART_NUM='21'       |

      | ReturnCumulative2Yr                      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative2Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_2YR_RETURN_CAMT='16.199008'                     |
      | PeerGroupRank2Yr                         | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank2Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_2Y_RET_PGRP_RNK_NUM='61'                           |
      | PeerGroupQuartile2Yr                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile2Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_2Y_RET_PGRP_QRTL_NUM='62'                      |
      | Noofinvestmentsrankedinpeergroup2Yr      | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup2Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.AN_2Y_RET_PGRP_PART_NUM='63'       |

  Scenario Outline: Verify the data uploaded for the year 2019 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='101'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='102'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='103'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2019','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2019','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='104'     |

  Scenario Outline: Verify the data uploaded for the year 2018 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='105'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='106'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='107'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2018','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2018','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='108'     |

  Scenario Outline: Verify the data uploaded for the year 2017 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='109'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='110'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='111'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2017','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2017','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='112'     |

  Scenario Outline: Verify the data uploaded for the year 2016 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='113'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='114'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='115'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2016','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2016','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='116'     |

  Scenario Outline: Verify the data uploaded for the year 2015 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='117'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='118'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='119'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2015','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2015','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='120'     |

  Scenario Outline: Verify the data uploaded for the year 2014 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='121'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='122'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='123'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2014','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2014','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='124'     |

  Scenario Outline: Verify the data uploaded for the year 2013 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='125'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='126'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='127'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2013','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2013','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='128'     |

  Scenario Outline: Verify the data uploaded for the year 2012 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='129'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='130'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='131'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2012','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2012','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='132'     |

  Scenario Outline: Verify the data uploaded for the year 2011 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='133'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='134'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='135'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2011','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2011','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='136'     |

  Scenario Outline: Verify the data uploaded for the year 2010 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='137'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='138'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='139'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='140'     |

  Scenario Outline: Verify the data uploaded for the year 2009 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='141'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='142'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='143'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2009','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2009','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='144'     |

  Scenario Outline: Verify the data uploaded for the year 2008 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='145'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='146'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='147'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2008','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2008','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='148'     |

  Scenario Outline: Verify the data uploaded for the year 2007 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='149'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='150'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='151'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2007','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2007','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='152'     |

  Scenario Outline: Verify the data uploaded for the year 2006 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='153'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='154'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='155'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2006','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2006','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='156'     |

  Scenario Outline: Verify the data uploaded for the year 2005 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='157'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='158'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='159'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2005','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2005','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='160'     |

  Scenario Outline: Verify the data uploaded for the year 2004 in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                              | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      | GroupInvestment                     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS GroupInvestment  from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_2='Eastspring Inv Asian Dynamic A'   |
      | BaseCurrency                        | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS BaseCurrency from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_13='US Dollar'                           |
      | FundLegalStructure                  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS FundLegalStructure from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_9='SICAV'                          |
      | MorningstarCategory                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS MorningstarCategory from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_4='EAA Fund Asia ex-Japan Equity' |
      | AsOfDate                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS AsOfDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY')           |
      | ISIN                                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ISIN from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.USR_CHAR_VAL_TXT_3='QSLU51346473'                                 |
      | InceptionDate                       | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS InceptionDate from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and trunc(w.USR_VAL_TMS_1)=to_date('07-02-2011','DD-MM-YYYY')  |
      | NetAsset                            | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS NetAsset from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and USR_VAL_CAMT_1='173720'                                         |

      | ReturnCumulative1Yr                 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='161'                          |
      | PeerGroupRank1Yr                    | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='162'                         |
      | PeerGroupQuartile1Yr                | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='163'                    |
      | Noofinvestmentsrankedinpeergroup1Yr | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS Noofinvestmentsrankedinpeergroup1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_PART_NUM='164'     |


  Scenario: Remove files already present in directory before running update scenario

    Given I remove below files with pattern in the host "dmp.ssh.inbound" from folder "${PEERRANK_DOWNLOAD_DIR}" if exists:
      | *.xlsx |

    And I remove below files with pattern in the host "dmp.ssh.inbound" from folder "${PEERRANK_UPLOAD_DIR}" if exists:
      | *.csv |

  Scenario: Run Excel to CSV Peer Ranking workflow for update file

    Given I copy files below from local folder "${testdata.path}/testdata" to the host "dmp.ssh.inbound" folder "${PEERRANK_DOWNLOAD_DIR}":
      | SICAV Mtking Peer Ranking Update (ES)_20200908.xlsx |

    And I assign "tests/test-data/intf-specs/gswf/template/EIS_PeerFundRanking_ExceltoCSV_DWH/request.xmlt" to variable "PROC_EXCEL"

    And I process the workflow template file "${PROC_EXCEL}" with below parameters and wait for the job to be completed
      | BEAN_SHELL_EXCEL_URI    | db://resource/EASTSPRING/script/EIS_Process_PeerRank_ExceltoCSV_XLSX.bshi |
      | MESSAGE_TYPE            | EIS_MT_MS_DWH_PEERRANKING_SG_SICAV                                        |
      | INPUT_DATA_DIR          | ${PEERRANK_DOWNLOAD_DIR}                                                  |
      | HEADERURI               | db://resource/propertyfiles/EISPeerRankingHeader.properties               |
      | FILEPATTERN             | *.xlsx                                                                    |
      | LOAD_FILE_PATTERNS      | Processed_*SICAV_Mtking_Peer_Ranking*.csv                                 |
      | PARALLELISM             | 1                                                                         |
      | OUTPUT_DATA_DIR         | ${PEERRANK_UPLOAD_DIR}                                                    |
      | PARAMETERSURI           | db://resource/propertyfiles                                               |
      | SUCCESS_ACTION          | LEAVE                                                                     |
      | LIST_SHEET_NAME         | SICAV M PR - All Funds1 (ES)                                              |
      | REPROCESSPROCESSEDFILES | true                                                                      |

    Then I expect below files to be present in the host "dmp.ssh.inbound" into folder "${PEERRANK_UPLOAD_DIR}" after processing:
      | ${OUTPUT_FILENAME_UPDATE_MY_SGSICAV} |

    Then I extract new job id from jblg table into a variable "JOB_ID"

    And I expect value of column "JBLG_ROW_COUNT" in the below SQL query equals to "1":
    """
      SELECT COUNT(1) AS JBLG_ROW_COUNT FROM FT_T_JBLG WHERE JOB_ID = '${JOB_ID}' AND TASK_SUCCESS_CNT ='17'
    """

  Scenario: Perform checks in WCRI for checking update scenario

    Then I expect value of column "WCRI_COUNT" in the below SQL query equals to "17":
    """
      SELECT COUNT(*) AS WCRI_COUNT FROM FT_T_WCRI
      WHERE DATA_SRC_ID = 'MSSGSICAV' AND DW_STATUS_NUM =1 and ACCT_SOK = (select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')
    """

  Scenario Outline: Verify the data uploaded in column <Column>

    Then I expect value of column "<Column>" in the below SQL query equals to "PASS":
    """
      <Query>
    """

    Examples: Data Verifications having value not zero
      | Column                   | Query                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
      | ReturnCumulative1Month   | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Month from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.RETURN_1M_CAMT='12.90033'                                                                                                      |
      | PeerGroupRank1Yr         | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and prd_start_tms is null and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='2'                                                                                                          |
      | PeerGroupQuartile1Yr2010 | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupQuartile1Yr2010 from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2010','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2010','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_QRTL_NUM='261' |
      | ReturnCumulative1Yr2004  | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS ReturnCumulative1Yr2004 from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1YR_RETURN_CAMT='262'       |
      | PeerGroupRank1Yr2004     | select CASE WHEN COUNT(*) = 1 THEN 'PASS' ELSE 'FAIL' END AS PeerGroupRank1Yr2004 from ft_w_wcri w where data_src_id = 'MSSGSICAV' and return_typ ='NetNAVGrossMgtFees' and dw_Status_num =1 and acct_sok in ((select acct_sok from FT_T_WAIR where iss_sok in (select iss_sok from ft_t_wisu where isin_id ='QSLU51346473' and dw_Status_num =1 and PREF_ID_CTXT_TYP='EISSECID') and dw_Status_num =1 and ACCT_ISSU_RL_TYP='AUT')) and trunc(w.prd_start_tms)=to_date('01-01-2004','DD-MM-YYYY') and trunc(w.as_of_tms)=to_date('31-12-2004','DD-MM-YYYY') and dw_status_num =1 and w.CUM_1Y_RET_PGRP_RNK_NUM='263'      |
